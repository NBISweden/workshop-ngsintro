{"title":"Read quality","markdown":{"yaml":{"title":"Read quality","author":"Malin Larsson","description":"Quality control of short reads with FastQC","format":"html"},"headingText":"VARIABLES","containsRefs":false,"markdown":"\n\n```{r,eval=TRUE,include=FALSE}\nlibrary(yaml)\nlibrary(here)\nupid <- yaml::read_yaml(here(\"_quarto.yml\"))$uppmax_project\n```\n\n```{css,include=FALSE}\n.workLocally{\nbackground-color: red;\n}\n```\n\n```{r,include=FALSE}\n#colours\nfastqdir <- \"/sw/courses/ngsintro/reseq/data/fastq\"\ncol_uppmax <- \"#f4f8e8\"\ncol_local <- \"#e5f4f8\"\n```\n\n## FastQC\n\nFastQC performes a series of quality control analyses, called modules. The output is a HTML report with one section for each module, and a summary evaluation of the results in the top. Entirely normal results are marked with a green tick, slightly abnormal results raise warnings (orange exclamation mark), and very unusual results raise failures (red cross).\n\nIt is important to stress that although the analyses appear to give a pass/fail result, these evaluations must be taken in the context of what you expect from your library. A 'normal' sample as far as FastQC is concerned is random and diverse. Some experiments may be expected to produce libraries which are biased in particular ways. You should treat the summary evaluations therefore as pointers to where you should concentrate your attention and understand why your library may not look random and diverse.\n\n## Data\n\nWe will run FastQC on three low-coverage whole genome sequencing (WGS) samples from the public 1000 Genomes project. To speed up the analysis we will only use data from a small genomic region. These are the exact same samples as will be used in the variant-calling workflow lab on Wednesday.  \n\nSample        | Description\n------------- | ----------\nHG00097       | Low coverage WGS\nHG00100       | Low coverage WGS\nHG00101       | Low coverage WGS\n\n## Run FastQC\n\n### Connect to Uppmax\n\nDuring this lab it is best to connect to UPPMAX via a remote desktop (ThinLinc). Instructions for this is available in Canvas under **Contents** > **Additional content** > **Connecting to UPPMAX**. Please follow the instructions in section 1.2 Remote desktop connection.\n\n### Book a node\n\nTo be able to run analyses in the terminal you should book a  compute node (or in this case just one core of a node). Make sure you only do this once each day because we have reserved one core per student for the course. If you haven't already reserved a core today please use this command:\n\n```{r,echo=FALSE,comment=\"\",class.output=\"bash\"}\ncat(paste0('salloc -A ',upid,' -t 04:00:00 -p core -n 1 --no-shell &'))\n```\n\nOnce your job allocation has been granted (should not take long) you can connect to the node using ssh. To find out the name of your node, use:\n\n```bash\nsqueue -u username\n```\n\nThe node name is found under nodelist header, you should only see one. Connect to that node:\n\n```bash\nssh -Y <nodename>\n```\n\n### Create a workspace\n\nYou should work in your folder under the course's nobackup folder, just like you have done during the previous labs. Start by creating a workspace for this exercise in your folder, and then move into it.\n\n```{r,echo=FALSE,comment=\"\",class.output=\"bash\"}\ncat(paste0('mkdir /proj/',upid,'/nobackup/username/qc\\n'))\ncat(paste0('cd /proj/',upid,'/nobackup/username/qc'))\n```\n\n### Symbolic links to data\n\nThe raw data files are located in\n\n```{r,echo=FALSE,comment=\"\",class.output=\"bash\"}\t\t\n cat(paste0(fastqdir))\n```\n\nInstead of copying the files to your workspace you should create symbolic links (soft-links) to them. Soft-linking files and folders allows you to work with them as if they were in your current directory, but without multiplying them. Create symbolic links to the fastq files in your workspace:\n\n```{r,echo=FALSE,comment=\"\",class.output=\"bash\"}\ncat(paste0('ln -s ',fastqdir,'/HG00097_1.fq\\n'))\ncat(paste0('ln -s ',fastqdir,'/HG00097_2.fq\\n'))  \ncat(paste0('ln -s ',fastqdir,'/HG00100_1.fq\\n'))\ncat(paste0('ln -s ',fastqdir,'/HG00100_2.fq\\n'))\ncat(paste0('ln -s ',fastqdir,'/HG00101_1.fq\\n'))\ncat(paste0('ln -s ',fastqdir,'/HG00101_2.fq\\n'))\n```\n\n### Accessing FastQC\n\nFastQC is installed in the module system on UPPMAX. Modules must be loaded *every time* you login to Rackham, or when you connect to a new compute node.  \nFirst load the bioinfo-tools module:\n\n```bash\nmodule load bioinfo-tools\n```\n\nThis makes it possible to load FastQC:\n\n```bash\nmodule load FastQC/0.11.8\n```\n\n### Run FastQC\n\nRun FastQC on all fastq files:\n\n```bash\nfastqc -q *.fq\n```\n\nThe output is .html documents that shows quality scores along the reads, and other information. Please check what new files were generated with the command:\n\n```bash\nls -lrt\n```\n\n## Check the results\n\nThe output from FastQC is a HTML report that should be opened in a web browser. When you have connected to Uppmax via ThinLinc you can open it on Rackham with this command:\n\n```bash\nfirefox --no-remote filename.html &\n```\n\nWe have made the output files that you just created available through the links below, so that you can look at them via your local web-browser:\n\nSample        | Read 1 | Read 2\n------------- | ---------- | --------\nHG00097       | [HG00097_1.fq](assets/HG00097_1_fastqc.html) | [HG00097_2.fq](assets/HG00097_2_fastqc.html)\nHG00100       | [HG00100_1.fq](assets/HG00100_1_fastqc.html) | [HG00100_2.fq](assets/HG00100_2_fastqc.html)\nHG00101       | [HG00101_1.fq](assets/HG00101_1_fastqc.html) | [HG00101_2.fq](assets/HG00101_2_fastqc.html)\n\n### Per Base Sequence Quality\n\nThis module shows the distribution of the quality scores at each position in the reads. The quality scores are represented by a Box and Whisker plot with the following elements:\n\n- The central red line is the median value.\n- The yellow box represents the inter-quartile range (25-75%).\n- The upper and lower whiskers represent the 10% and 90% points\n- The blue line represents the mean quality\n\nThe background of the graph divides the y axis into very good quality calls (green), calls of reasonable quality (orange), and calls of poor quality (red).\n\n#### Questions\n\n1. Which positions in the reads have a median phred-score above 28 (very good quality calls) in each sample?  \n2. Do any of the samples have warnings or failures in the Per Base Sequence Quality module?\n3. Why? Please look in the [documentation of this module](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/2%20Per%20Base%20Sequence%20Quality.html).  \n\n### Sequence Length Distribution\n\nThis module shows the length distribution of the reads in the file.  \n\n#### Questions\n\n4. How long are the reads?\n5. Do any of the samples have warnings or failures in the Sequence Length Distribution module?\n6. Why? Please look in the [documentation of this module](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/7%20Sequence%20Length%20Distribution.html)\n\n## Answers  \n\nWhen you have finished the exercise, please have a look at this document with [answers to questions](lab_qc_answers.pdf), and compare them with your answers.  \n\n## Documentation\n\n- [FastQC](https://www.bioinformatics.babraham.ac.uk/projects/fastqc)\n- If you want to learn more details about FastQC please have a look at this video by the [Babraham Bioinformatics Institute]( http://www.youtube.com/watch?v=bz93ReOv87Y).\n","srcMarkdownNoYaml":"\n\n```{r,eval=TRUE,include=FALSE}\nlibrary(yaml)\nlibrary(here)\nupid <- yaml::read_yaml(here(\"_quarto.yml\"))$uppmax_project\n```\n\n```{css,include=FALSE}\n.workLocally{\nbackground-color: red;\n}\n```\n\n```{r,include=FALSE}\n## VARIABLES\n#colours\nfastqdir <- \"/sw/courses/ngsintro/reseq/data/fastq\"\ncol_uppmax <- \"#f4f8e8\"\ncol_local <- \"#e5f4f8\"\n```\n\n## FastQC\n\nFastQC performes a series of quality control analyses, called modules. The output is a HTML report with one section for each module, and a summary evaluation of the results in the top. Entirely normal results are marked with a green tick, slightly abnormal results raise warnings (orange exclamation mark), and very unusual results raise failures (red cross).\n\nIt is important to stress that although the analyses appear to give a pass/fail result, these evaluations must be taken in the context of what you expect from your library. A 'normal' sample as far as FastQC is concerned is random and diverse. Some experiments may be expected to produce libraries which are biased in particular ways. You should treat the summary evaluations therefore as pointers to where you should concentrate your attention and understand why your library may not look random and diverse.\n\n## Data\n\nWe will run FastQC on three low-coverage whole genome sequencing (WGS) samples from the public 1000 Genomes project. To speed up the analysis we will only use data from a small genomic region. These are the exact same samples as will be used in the variant-calling workflow lab on Wednesday.  \n\nSample        | Description\n------------- | ----------\nHG00097       | Low coverage WGS\nHG00100       | Low coverage WGS\nHG00101       | Low coverage WGS\n\n## Run FastQC\n\n### Connect to Uppmax\n\nDuring this lab it is best to connect to UPPMAX via a remote desktop (ThinLinc). Instructions for this is available in Canvas under **Contents** > **Additional content** > **Connecting to UPPMAX**. Please follow the instructions in section 1.2 Remote desktop connection.\n\n### Book a node\n\nTo be able to run analyses in the terminal you should book a  compute node (or in this case just one core of a node). Make sure you only do this once each day because we have reserved one core per student for the course. If you haven't already reserved a core today please use this command:\n\n```{r,echo=FALSE,comment=\"\",class.output=\"bash\"}\ncat(paste0('salloc -A ',upid,' -t 04:00:00 -p core -n 1 --no-shell &'))\n```\n\nOnce your job allocation has been granted (should not take long) you can connect to the node using ssh. To find out the name of your node, use:\n\n```bash\nsqueue -u username\n```\n\nThe node name is found under nodelist header, you should only see one. Connect to that node:\n\n```bash\nssh -Y <nodename>\n```\n\n### Create a workspace\n\nYou should work in your folder under the course's nobackup folder, just like you have done during the previous labs. Start by creating a workspace for this exercise in your folder, and then move into it.\n\n```{r,echo=FALSE,comment=\"\",class.output=\"bash\"}\ncat(paste0('mkdir /proj/',upid,'/nobackup/username/qc\\n'))\ncat(paste0('cd /proj/',upid,'/nobackup/username/qc'))\n```\n\n### Symbolic links to data\n\nThe raw data files are located in\n\n```{r,echo=FALSE,comment=\"\",class.output=\"bash\"}\t\t\n cat(paste0(fastqdir))\n```\n\nInstead of copying the files to your workspace you should create symbolic links (soft-links) to them. Soft-linking files and folders allows you to work with them as if they were in your current directory, but without multiplying them. Create symbolic links to the fastq files in your workspace:\n\n```{r,echo=FALSE,comment=\"\",class.output=\"bash\"}\ncat(paste0('ln -s ',fastqdir,'/HG00097_1.fq\\n'))\ncat(paste0('ln -s ',fastqdir,'/HG00097_2.fq\\n'))  \ncat(paste0('ln -s ',fastqdir,'/HG00100_1.fq\\n'))\ncat(paste0('ln -s ',fastqdir,'/HG00100_2.fq\\n'))\ncat(paste0('ln -s ',fastqdir,'/HG00101_1.fq\\n'))\ncat(paste0('ln -s ',fastqdir,'/HG00101_2.fq\\n'))\n```\n\n### Accessing FastQC\n\nFastQC is installed in the module system on UPPMAX. Modules must be loaded *every time* you login to Rackham, or when you connect to a new compute node.  \nFirst load the bioinfo-tools module:\n\n```bash\nmodule load bioinfo-tools\n```\n\nThis makes it possible to load FastQC:\n\n```bash\nmodule load FastQC/0.11.8\n```\n\n### Run FastQC\n\nRun FastQC on all fastq files:\n\n```bash\nfastqc -q *.fq\n```\n\nThe output is .html documents that shows quality scores along the reads, and other information. Please check what new files were generated with the command:\n\n```bash\nls -lrt\n```\n\n## Check the results\n\nThe output from FastQC is a HTML report that should be opened in a web browser. When you have connected to Uppmax via ThinLinc you can open it on Rackham with this command:\n\n```bash\nfirefox --no-remote filename.html &\n```\n\nWe have made the output files that you just created available through the links below, so that you can look at them via your local web-browser:\n\nSample        | Read 1 | Read 2\n------------- | ---------- | --------\nHG00097       | [HG00097_1.fq](assets/HG00097_1_fastqc.html) | [HG00097_2.fq](assets/HG00097_2_fastqc.html)\nHG00100       | [HG00100_1.fq](assets/HG00100_1_fastqc.html) | [HG00100_2.fq](assets/HG00100_2_fastqc.html)\nHG00101       | [HG00101_1.fq](assets/HG00101_1_fastqc.html) | [HG00101_2.fq](assets/HG00101_2_fastqc.html)\n\n### Per Base Sequence Quality\n\nThis module shows the distribution of the quality scores at each position in the reads. The quality scores are represented by a Box and Whisker plot with the following elements:\n\n- The central red line is the median value.\n- The yellow box represents the inter-quartile range (25-75%).\n- The upper and lower whiskers represent the 10% and 90% points\n- The blue line represents the mean quality\n\nThe background of the graph divides the y axis into very good quality calls (green), calls of reasonable quality (orange), and calls of poor quality (red).\n\n#### Questions\n\n1. Which positions in the reads have a median phred-score above 28 (very good quality calls) in each sample?  \n2. Do any of the samples have warnings or failures in the Per Base Sequence Quality module?\n3. Why? Please look in the [documentation of this module](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/2%20Per%20Base%20Sequence%20Quality.html).  \n\n### Sequence Length Distribution\n\nThis module shows the length distribution of the reads in the file.  \n\n#### Questions\n\n4. How long are the reads?\n5. Do any of the samples have warnings or failures in the Sequence Length Distribution module?\n6. Why? Please look in the [documentation of this module](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/7%20Sequence%20Length%20Distribution.html)\n\n## Answers  \n\nWhen you have finished the exercise, please have a look at this document with [answers to questions](lab_qc_answers.pdf), and compare them with your answers.  \n\n## Documentation\n\n- [FastQC](https://www.bioinformatics.babraham.ac.uk/projects/fastqc)\n- If you want to learn more details about FastQC please have a look at this video by the [Babraham Bioinformatics Institute]( http://www.youtube.com/watch?v=bz93ReOv87Y).\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"kable","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"left","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":false,"wrap":"none","default-image-extension":"png","to":"html","filters":["../../assets/custom.lua","reveal-header","lightbox"],"include-in-header":["../../assets/fonts/head.html"],"toc":true,"toc-depth":4,"number-sections":true,"output-file":"lab_qc.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.433","bibliography":["../../references.bib"],"csl":"../../apa.csl","knitr":{"opts_chunk":{"results":"hold"}},"uppmax_project":"naiss2023-22-862","nsc_project":"naiss2023-22-862","uppmax_res_1":"naiss2023-22-862_1","uppmax_res_2":"naiss2023-22-862_2","uppmax_res_3":"naiss2023-22-862_3","uppmax_res_4":"naiss2023-22-862_4","uppmax_res_5":"naiss2023-22-862_5","location":"uppsala","assistants":["AJ: Anna Johansson","BV: Björn Viklund","DA: Dag Ahren","FB: Franziska Bonath","JH: Jason Hill","JB: Joakim Bygdell","JA: Juliana Assis","KL: Katarina Lejonlid","KB: Kristina Benevides","LK: Linda Köhn","LV: Louella Vasquez","MD: Martin Dahlö","MG: Maxime Garcia","ML: Malin Larsson","MM: Markus Mayrhofer","NN: Nina Norgren","OVP: Olga Vinnere Pettersson","PA: Prasoon Agarwal","PP: Paul Pyl","RF: Roy Francis","VVH: Vincent van Hoef","SD: Sebastian DiLorenzo"],"schedule_message":"Coffee breaks are planned for approximately 10:00 and 14:30 every day.","colors":{"primary":"#95b540","secondary":"#E9F2D1"},"packages":{"packages_cran_student":["BiocManager","remotes","dplyr","ggplot2","pheatmap","stringr","tidyr"],"packages_bioc_student":["DESeq2","edgeR","goseq","GO.db","org.Mm.eg.db","reactome.db"],"packages_github_student":null,"packages_cran_repo":["bookdown","captioner","here","htmlTable","knitr","leaflet","lubridate","markdown","pagedown","yaml"],"packages_bioc_repo":null,"packages_github_repo":null},"quarto-required":">=1.2.2","theme":"../../assets/css/custom.scss","smooth-scroll":true,"toc-location":"right","number-depth":4,"code-copy":true,"title-block-banner":"#E9F2D1","callout-icon":false,"date":"last-modified","date-format":"DD-MMM-YYYY","lightbox":{"match":"auto"},"title":"Read quality","author":"Malin Larsson","description":"Quality control of short reads with FastQC"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html","revealjs"]}